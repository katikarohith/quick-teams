<!doctype html>
<html>
  <head>
    <title>Dashboard - Quick Teams</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body>
    <%- include('partials/header') %>

    <main class="container py-5">
      <div class="row">
        <div class="col-md-4">
          <div class="card p-3">
            <h5>Welcome, <%= user.name %></h5>
            <p>Email: <%= user.email %></p>
            <p><strong>Skills:</strong> <%= user.skills.join(', ') %></p>
            <p><strong>Needs:</strong> <%= user.needs.join(', ') %></p>
            <p><strong>Availability:</strong> <%= user.availability %></p>
            <a href="/dashboard/profile" class="btn btn-sm btn-outline-primary">Edit Profile</a>
          </div>

          <div class="mt-3 card p-3">
            <h5>Your Team Members</h5>
            <% if (user.teamMembers && user.teamMembers.length) { %>
              <ul class="list-group">
                <% user.teamMembers.forEach(tm => { %>
                  <li class="list-group-item"><%= tm.name %> (<%= tm.email %>)</li>
                <% }) %>
              </ul>
            <% } else { %>
              <p class="text-muted">No team members yet</p>
            <% } %>
          </div>

          <div class="mt-3 card p-3">
            <h5>Your Joined Events</h5>
            <% if (user.joinedEvents && user.joinedEvents.length) { %>
              <ul class="list-group">
                <% user.joinedEvents.forEach(ev => { %>
                  <li class="list-group-item"><%= ev %></li>
                <% }) %>
              </ul>
            <% } else { %>
              <p class="text-muted">You haven’t joined any events yet</p>
            <% } %>
          </div>

          <div class="mt-3 card p-3">
            <h5>Notifications</h5>
            <% if (user.notifications && user.notifications.length) { %>
              <ul class="list-group">
                <% user.notifications.forEach(n => { %>
                  <li class="list-group-item">
                    Request from <%= n.from.name %> (<%= n.from.email %>)
                    <% if (n.status === "pending") { %>
                      <form method="post" action="/dashboard/accept/<%= n.from._id %>" style="display:inline;">
                        <button class="btn btn-sm btn-success">Accept</button>
                      </form>
                    <% } else { %>
                      ✅ <%= n.status %>
                    <% } %>
                  </li>
                <% }) %>
              </ul>
            <% } else { %>
              <p class="text-muted">No notifications</p>
            <% } %>
          </div>
        </div>

        <div class="col-md-8">
          <div class="card p-3">
            <h4>Dashboard Home</h4>
            <p>Use matchmaking and community to connect with others.</p>
          </div>
        </div>
      </div>
    </main>

    <%- include('partials/footer') %>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>